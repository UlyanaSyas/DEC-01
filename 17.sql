/*
1. ??????? ????? ? ??????? ?????, ???????? ? ??????? ????????????.
??????? ????????? EMPLOYEE. ??????? EMPLOYEES_VU.
*/

CREATE OR REPLACE VIEW EMPLOYEES_VU 
AS
SELECT  employee_id, 
		last_name "EMPLOYEE", 
		department_id
FROM EMPLOYEES;


/*
2. ???????????.
*/

SELECT *
FROM EMPLOYEES_VU;

/*
3. ???????? ?????? ? ??????.
*/

SELECT 
	EMPLOYEE, 
	department_id
FROM EMPLOYEES_VU;

/*
4. ??????? ????? DEPT50 ? ??????? ?????, ???????? ? ??????? ???????????? 80.
??????? ??????? EMPNO, EMPLOYEE, DEPTNO. ?????????? ??????? ??????????? ?? ???????.
*/

DROP VIEW DEPT50; -- ??? ????? ?? ?????????, ??? ????

CREATE VIEW DEPT50 
AS
SELECT
	employee_id "EMPNO",
	last_name "EMPLOYEE", 
	department_id "DEPTNO"
FROM EMPLOYEES
WHERE department_id = 80
WITH CHECK OPTION CONSTRAINT EMP_DEPT_50; 

/*
5. ???????? ????? ? ??????.
*/

SELECT *
FROM DEPT50;

DESCRIBE DEPT50;

/*
6. ????????? Abel ? 80-? ?????.
*/

UPDATE DEPT50
SET DEPTNO = 50
WHERE EMPLOYEE = 'Abel';

-- ??, ? 80-? ??? ??, ?? ???? ???????? ????????? ??? ??? ???????? 50-? ????? 

/*
7. ?????????? ????? ???? ????. ??????? ??? ? ????? ????? ?????.
*/

SELECT *
FROM USER_VIEWS;

SELECT 
	view_name,
	text
FROM USER_VIEWS
WHERE view_name = 'DEPT50';

/*
8. ?????? ??? ? ?????.
*/

DROP VIEW DEPT50;

DROP VIEW EMPLOYEES_VU;

/*
9. ??????? ??????? DEPT. ??????????? ?? ????????.
*/

CREATE TABLE DEPT
(
ID     NUMBER(7),
NAME   VARCHAR2(25),
	CONSTRAINT DEPT_PK PRIMARY KEY(ID)
);

SELECT *
FROM DEPT;

/*
10. ??????? ???????, ??????? ????? ???????? ? ????????? ??????.
?????????????????? ?????? ?????????? ? 200, ? ????? ??????????? ???????? 1000. ????????? ?????????????????? ?? 10.
??????? ??????? DEPT_ID_SEQ.
*/

CREATE SEQUENCE DEPT_ID_SEQ
START WITH 200
INCREMENT BY 10
MAXVALUE 1000;

/*
11. ??????? ??????, ??? ??????? ????? ? ??????? DEPT, ????????? ???????. ???????? ??? ?????? Education ? Administration.
*/

INSERT INTO DEPT VALUES
(DEPT_ID_SEQ.nextval,
'Education');

INSERT INTO DEPT VALUES
(DEPT_ID_SEQ.nextval,
'Administration');

/*
12. ????? ? ????????? ?? ???, ???????????? ????????, ???????, ? ????????? ?????.
*/

SELECT 
	sequence_name,
	max_value,
	increment_by,
	last_number
FROM USER_SEQUENCES;

/*
13. ??????? ??????? ? ??????? ? ???????. ??????? EMP1. ????? ????? ??? ????????.
*/

CREATE SYNONYM EMP1 FOR EMPLOYEES;

SELECT *
FROM all_synonyms; -- ??? user_synonyms, ?? ??? ?????? ??? ???????????? ????

/*
14. ???????? ??????? EMP1.
*/

DROP SYNONYM EMP1;

/*
15. ??????? ?? ?????????? ?????? ??? ??????? NAME ??????? DEPT.
*/

CREATE INDEX DEPT_NAME_NONUNIQUE_INDX ON DEPT(NAME);

/*
16. ??????? ??????? SALES_DEPT. ?????? ??? PK - SALES_PK_IDX. ????? ????? ? ??????? ??? ???????, ??? ???????, ? ?????. 
*/

DROP TABLE SALES_DEPT;

CREATE TABLE SALES_DEPT
(
Team_ID	NUMBER(3),
Location	VARCHAR2(30),
	CONSTRAINT SALES_PK_IDX PRIMARY KEY(Team_ID)
);

SELECT 
	index_name,
	table_name,
	uniqueness
FROM USER_INDEXES 
WHERE table_name = 'SALES_DEPT';

/*
17. ???????? ??? ? ?????, ?? ??????? ? ????????.
*/

DROP TABLE SALES_DEPT;

DROP SEQUENCE DEPT_ID_SEQ;

DROP TABLE DEPT;